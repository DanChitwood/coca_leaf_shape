# Coca leaf shape 🍃
A repository containing data, methods, and figures analyzing coca leaf shape

> :white_check_mark: For a tutorial reproducing the figure shown below, please see the Jupyter notebook in this repository, [coca_leaves.ipynb](https://github.com/DanChitwood/coca_leaf_shape/blob/main/coca_leaves.ipynb).
>
**Figure 2: Coca leaves from cultivated varieties and wild species.** 18 randomly selected leaves are shown for each cultivated variety and wild species by row. The four different cultivated types are indicated by color (Ipadu, blue; Coca, orange; Truxillense, green; Novogranatense, red) as well as the four wild species (*E. cataractarum*, purple; *E. foetidum*, brown; *E. gracilipes*, pink; *E. lineolatum*, gray). Base and tip landmarks are indicated by black points and centimeter scale for each leaf is provided.
![alt_image](https://github.com/DanChitwood/coca_leaf_shape/blob/main/Figure2.png)

**Figure 3: Allometry, morphospaces, and prediction for coca leaf types. A)** Allometry plot modeling length as a function of width in centimeters. Linear models and data points for each leaf type are indicated by color. The isometric line is indicated by dotted gray line. Axes are log-scale and equal. **B)** The overall generalized Procrustes analysis (GPA) mean leaf (magenta) and all leaves superimposed as transparent black lines. **C)** Mean leaves (magenta) for each type (indicated by text and color) and respective leaves in transparent black outlines superimposed to their respective mean. **D)** A principal component analysis (PCA) morphospace. Eigenleaves are plotted in the background as gray outlines and leaf types indicated by color. **E)** Confusion matrix resulting from a linear discriminant analysis (LDA) model, indicating the true leaf type along rows and its predicted class along columns. The proportion of each leaf type predicted is indicated by color and numbers. **F)** Sample LDA scores from the model, with the leaf type of each data point indicated by color.
![alt_image](https://github.com/DanChitwood/coca_leaf_shape/blob/main/Figure3.png)

**Figure 4: Comparison of average leaves from cultivated varieties.** Reference average leaf shapes for each cultivated variety are hierarchically clustered by row, colored gray, and the three main clusters indicated by number. Reference leaves are transparent magenta, and the differences relative to the reference leaf are magnified by three to discern shape trends. The variety type is indicated by color.
![alt_image](https://github.com/DanChitwood/coca_leaf_shape/blob/main/Figure4.png)

**Figure 5: Prediction of cultivated coca varieties using leaf shape. A)** Confusion matrix resulting from a linear discriminant analysis (LDA) model, indicating the true leaf type along rows and its predicted class along columns. The proportion of each leaf type predicted is indicated by color and numbers. **B)** Sample LDA scores from the model, with the leaf type of each data point indicated by color. Varieties are arranged by hierarchical clustering on average leaf shape.
![alt_image](https://github.com/DanChitwood/coca_leaf_shape/blob/main/Figure5.png)
